<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Master Billiards Pro</title>
    <style>
        body { background: #111; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; color: white; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        #game-container { position: relative; }
        canvas { border: 12px solid #3e2723; border-radius: 8px; box-shadow: 0 0 40px rgba(0,0,0,0.8); cursor: crosshair; background: #2e7d32; }
        #menu-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: flex; flex-direction: column; justify-content: center; align-items: center; border-radius: 8px; z-index: 10; }
        h1 { font-size: 3rem; margin-bottom: 1rem; color: #f1c40f; text-shadow: 2px 2px #000; }
        button { padding: 15px 40px; font-size: 1.2rem; background: #27ae60; color: white; border: none; border-radius: 30px; cursor: pointer; transition: 0.3s; }
        button:hover { background: #2ecc71; transform: scale(1.1); }
        .stats { position: absolute; top: -40px; width: 100%; display: flex; justify-content: space-between; font-weight: bold; color: #aaa; }
    </style>
</head>
<body>

<div id="game-container">
    <div class="stats">
        <span>BOLAS METIDAS: <span id="score">0</span></span>
        <span>MODO: PROFESIONAL</span>
    </div>
    
    <div id="menu-overlay">
        <h1>BILLAR MASTER PRO</h1>
        <button onclick="startGame()">JUGAR AHORA</button>
    </div>

    <canvas id="poolTable"></canvas>
</div>

<script>
const canvas = document.getElementById('poolTable');
const ctx = canvas.getContext('2d');
const scoreEl = document.getElementById('score');
const menu = document.getElementById('menu-overlay');

canvas.width = 800;
canvas.height = 400;

let balls = [];
let score = 0;
let gameState = 'MENU';
const ballRadius = 10;
const friction = 0.985;
const holes = [
    {x: 0, y: 0}, {x: 400, y: 0}, {x: 800, y: 0},
    {x: 0, y: 400}, {x: 400, y: 400}, {x: 800, y: 400}
];

class Ball {
    constructor(x, y, color, isWhite = false) {
        this.x = x; this.y = y; this.color = color;
        this.isWhite = isWhite; this.vx = 0; this.vy = 0;
        this.inHole = false;
    }
    draw() {
        if (this.inHole) return;
        ctx.beginPath();
        ctx.arc(this.x, this.y, ballRadius, 0, Math.PI * 2);
        ctx.fillStyle = this.color;
        ctx.fill();
        ctx.closePath();
    }
    update() {
        if (this.inHole) return;
        this.x += this.vx; this.y += this.vy;
        this.vx *= friction; this.vy *= friction;
        
        // Colisión con agujeros
        holes.forEach(h => {
            let d = Math.hypot(this.x - h.x, this.y - h.y);
            if (d < 20) {
                if (this.isWhite) {
                    this.x = 200; this.y = 200; this.vx = 0; this.vy = 0;
                } else {
                    this.inHole = true;
                    score++;
                    scoreEl.innerText = score;
                }
            }
        });

        // Rebotes
        if (this.x < ballRadius || this.x > canvas.width - ballRadius) this.vx *= -1;
        if (this.y < ballRadius || this.y > canvas.height - ballRadius) this.vy *= -1;
    }
}

function startGame() {
    menu.style.display = 'none';
    gameState = 'PLAYING';
    initGame();
}

function initGame() {
    balls = [new Ball(200, 200, 'white', true)];
    for(let i=0; i<15; i++) {
        balls.push(new Ball(500 + Math.random()*200, 100 + Math.random()*200, i%2? 'red':'yellow'));
    }
}

// (Aquí va la lógica de colisiones igual que la anterior...)
function checkCollisions() {
    for (let i = 0; i < balls.length; i++) {
        for (let j = i + 1; j < balls.length; j++) {
            if (balls[i].inHole || balls[j].inHole) continue;
            let dx = balls[j].x - balls[i].x;
            let dy = balls[j].y - balls[i].y;
            let dist = Math.hypot(dx, dy);
            if (dist < ballRadius * 2) {
                let angle = Math.atan2(dy, dx);
                let vx1 = balls[i].vx * Math.cos(angle) + balls[i].vy * Math.sin(angle);
                let vy1 = balls[i].vy * Math.cos(angle) - balls[i].vx * Math.sin(angle);
                let vx2 = balls[j].vx * Math.cos(angle) + balls[j].vy * Math.sin(angle);
                let vy2 = balls[j].vy * Math.cos(angle) - balls[j].vx * Math.sin(angle);
                balls[i].vx = vx2 * Math.cos(angle) - vy1 * Math.sin(angle);
                balls[i].vy = vy1 * Math.cos(angle) + vx2 * Math.sin(angle);
                balls[j].vx = vx1 * Math.cos(angle) - vy2 * Math.sin(angle);
                balls[j].vy = vy2 * Math.cos(angle) + vx1 * Math.sin(angle);
            }
        }
    }
}

canvas.addEventListener('mousedown', (e) => {
    if (gameState !== 'PLAYING') return;
    const rect = canvas.getBoundingClientRect();
    const mX = e.clientX - rect.left;
    const mY = e.clientY - rect.top;
    balls[0].vx = (balls[0].x - mX) * 0.1;
    balls[0].vy = (balls[0].y - mY) * 0.1;
});

function loop() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    // Dibujar agujeros
    ctx.fillStyle = 'black';
    holes.forEach(h => { ctx.beginPath(); ctx.arc(h.x, h.y, 20, 0, Math.PI*2); ctx.fill(); });
    
    if (gameState === 'PLAYING') {
        checkCollisions();
        balls.forEach(b => { b.update(); b.draw(); });
    }
    requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
